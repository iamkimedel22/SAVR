{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 70, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Administrator/Downloads/SAVR/lib/auth.ts"],"sourcesContent":["import jwt from \"jsonwebtoken\"\r\nimport type { NextRequest } from \"next/server\"\r\n\r\nconst JWT_SECRET = process.env.JWT_SECRET || \"your-secret-key-change-in-production\"\r\n\r\nexport function generateToken(userId: number) {\r\n  return jwt.sign({ userId }, JWT_SECRET, { expiresIn: \"7d\" })\r\n}\r\n\r\nexport function verifyToken(token: string) {\r\n  try {\r\n    return jwt.verify(token, JWT_SECRET) as { userId: number }\r\n  } catch {\r\n    return null\r\n  }\r\n}\r\n\r\nexport function getAuthToken(request: NextRequest) {\r\n  const authHeader = request.headers.get(\"authorization\")\r\n  if (!authHeader?.startsWith(\"Bearer \")) {\r\n    return null\r\n  }\r\n  return authHeader.slice(7)\r\n}\r\n"],"names":[],"mappings":";;;;;;;;AAAA;;AAGA,MAAM,aAAa,QAAQ,GAAG,CAAC,UAAU,IAAI;AAEtC,SAAS,cAAc,MAAc;IAC1C,OAAO,kJAAG,CAAC,IAAI,CAAC;QAAE;IAAO,GAAG,YAAY;QAAE,WAAW;IAAK;AAC5D;AAEO,SAAS,YAAY,KAAa;IACvC,IAAI;QACF,OAAO,kJAAG,CAAC,MAAM,CAAC,OAAO;IAC3B,EAAE,OAAM;QACN,OAAO;IACT;AACF;AAEO,SAAS,aAAa,OAAoB;IAC/C,MAAM,aAAa,QAAQ,OAAO,CAAC,GAAG,CAAC;IACvC,IAAI,CAAC,YAAY,WAAW,YAAY;QACtC,OAAO;IACT;IACA,OAAO,WAAW,KAAK,CAAC;AAC1B"}},
    {"offset": {"line": 154, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Administrator/Downloads/SAVR/lib/db.ts"],"sourcesContent":["import mysql from \"mysql2/promise\"\r\n\r\nconst pool = mysql.createPool({\r\n  host: process.env.MYSQL_HOST || \"localhost\",\r\n  user: process.env.MYSQL_USER || \"root\",\r\n  password: process.env.MYSQL_PASSWORD || \"\",\r\n  database: process.env.MYSQL_DATABASE || \"savr\",\r\n  port: Number(process.env.MYSQL_PORT || 3306),\r\n  waitForConnections: true,\r\n  connectionLimit: 10,\r\n  queueLimit: 0,\r\n})\r\n\r\nexport async function executeQuery(query: string, values?: any[]) {\r\n  try {\r\n    const connection = await pool.getConnection()\r\n    const [results] = await connection.execute(query, values)\r\n    connection.release()\r\n    return results\r\n  } catch (error) {\r\n    console.error(\"Database error:\", error)\r\n    throw error\r\n  }\r\n}\r\n\r\nexport default pool\r\n"],"names":[],"mappings":";;;;;;AAAA;;AAEA,MAAM,OAAO,8IAAK,CAAC,UAAU,CAAC;IAC5B,MAAM,QAAQ,GAAG,CAAC,UAAU,IAAI;IAChC,MAAM,QAAQ,GAAG,CAAC,UAAU,IAAI;IAChC,UAAU,QAAQ,GAAG,CAAC,cAAc,IAAI;IACxC,UAAU,QAAQ,GAAG,CAAC,cAAc,IAAI;IACxC,MAAM,OAAO,QAAQ,GAAG,CAAC,UAAU,IAAI;IACvC,oBAAoB;IACpB,iBAAiB;IACjB,YAAY;AACd;AAEO,eAAe,aAAa,KAAa,EAAE,MAAc;IAC9D,IAAI;QACF,MAAM,aAAa,MAAM,KAAK,aAAa;QAC3C,MAAM,CAAC,QAAQ,GAAG,MAAM,WAAW,OAAO,CAAC,OAAO;QAClD,WAAW,OAAO;QAClB,OAAO;IACT,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,mBAAmB;QACjC,MAAM;IACR;AACF;uCAEe"}},
    {"offset": {"line": 188, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Administrator/Downloads/SAVR/app/api/dashboard/route.ts"],"sourcesContent":["import { type NextRequest, NextResponse } from \"next/server\"\r\nimport { verifyToken, getAuthToken } from \"@/lib/auth\"\r\nimport { executeQuery } from \"@/lib/db\"\r\n\r\nexport async function GET(request: NextRequest) {\r\n  try {\r\n    const token = getAuthToken(request)\r\n    if (!token) {\r\n      return NextResponse.json({ message: \"Unauthorized\" }, { status: 401 })\r\n    }\r\n\r\n    const decoded = verifyToken(token)\r\n    if (!decoded) {\r\n      return NextResponse.json({ message: \"Invalid token\" }, { status: 401 })\r\n    }\r\n\r\n    const userId = decoded.userId\r\n\r\n    // Get user info\r\n    const users = await executeQuery(\"SELECT name FROM users WHERE id = ?\", [userId])\r\n    const user = (users as any[])[0]\r\n\r\n    // Get total balance (sum of all transactions)\r\n    const balanceResult = await executeQuery(\r\n      \"SELECT COALESCE(SUM(CASE WHEN type='income' THEN amount ELSE -amount END), 0) as totalBalance FROM transactions WHERE user_id = ?\",\r\n      [userId],\r\n    )\r\n    const totalBalance = (balanceResult as any[])[0]?.totalBalance || 0\r\n\r\n    // Get monthly income\r\n    const incomeResult = await executeQuery(\r\n      \"SELECT COALESCE(SUM(amount), 0) as monthlyIncome FROM transactions WHERE user_id = ? AND type='income' AND MONTH(date) = MONTH(CURDATE()) AND YEAR(date) = YEAR(CURDATE())\",\r\n      [userId],\r\n    )\r\n    const monthlyIncome = (incomeResult as any[])[0]?.monthlyIncome || 0\r\n\r\n    // Get monthly expenses\r\n    const expenseResult = await executeQuery(\r\n      \"SELECT COALESCE(SUM(amount), 0) as monthlyExpense FROM transactions WHERE user_id = ? AND type='expense' AND MONTH(date) = MONTH(CURDATE()) AND YEAR(date) = YEAR(CURDATE())\",\r\n      [userId],\r\n    )\r\n    const monthlyExpense = (expenseResult as any[])[0]?.monthlyExpense || 0\r\n\r\n    // Get savings goals progress\r\n    const goalsResult = await executeQuery(\r\n      \"SELECT COALESCE(SUM(current_amount) / NULLIF(SUM(target_amount), 0) * 100, 0) as progress FROM savings_goals WHERE user_id = ? AND current_amount > 0\",\r\n      [userId],\r\n    )\r\n    const savingsGoalsProgress = (goalsResult as any[])[0]?.progress || 0\r\n\r\n    return NextResponse.json({\r\n      userName: user?.name || \"User\",\r\n      totalBalance: Number(totalBalance),\r\n      monthlyIncome: Number(monthlyIncome),\r\n      monthlyExpense: Number(monthlyExpense),\r\n      savingsGoalsProgress: Number(savingsGoalsProgress),\r\n    })\r\n  } catch (error) {\r\n    console.error(\"[v0] Dashboard API error:\", error)\r\n    return NextResponse.json({ message: \"Internal server error\" }, { status: 500 })\r\n  }\r\n}\r\n"],"names":[],"mappings":";;;;AAAA;AACA;AACA;;;;AAEO,eAAe,IAAI,OAAoB;IAC5C,IAAI;QACF,MAAM,QAAQ,IAAA,6HAAY,EAAC;QAC3B,IAAI,CAAC,OAAO;YACV,OAAO,gJAAY,CAAC,IAAI,CAAC;gBAAE,SAAS;YAAe,GAAG;gBAAE,QAAQ;YAAI;QACtE;QAEA,MAAM,UAAU,IAAA,4HAAW,EAAC;QAC5B,IAAI,CAAC,SAAS;YACZ,OAAO,gJAAY,CAAC,IAAI,CAAC;gBAAE,SAAS;YAAgB,GAAG;gBAAE,QAAQ;YAAI;QACvE;QAEA,MAAM,SAAS,QAAQ,MAAM;QAE7B,gBAAgB;QAChB,MAAM,QAAQ,MAAM,IAAA,2HAAY,EAAC,uCAAuC;YAAC;SAAO;QAChF,MAAM,OAAO,AAAC,KAAe,CAAC,EAAE;QAEhC,8CAA8C;QAC9C,MAAM,gBAAgB,MAAM,IAAA,2HAAY,EACtC,qIACA;YAAC;SAAO;QAEV,MAAM,eAAe,AAAC,aAAuB,CAAC,EAAE,EAAE,gBAAgB;QAElE,qBAAqB;QACrB,MAAM,eAAe,MAAM,IAAA,2HAAY,EACrC,8KACA;YAAC;SAAO;QAEV,MAAM,gBAAgB,AAAC,YAAsB,CAAC,EAAE,EAAE,iBAAiB;QAEnE,uBAAuB;QACvB,MAAM,gBAAgB,MAAM,IAAA,2HAAY,EACtC,gLACA;YAAC;SAAO;QAEV,MAAM,iBAAiB,AAAC,aAAuB,CAAC,EAAE,EAAE,kBAAkB;QAEtE,6BAA6B;QAC7B,MAAM,cAAc,MAAM,IAAA,2HAAY,EACpC,yJACA;YAAC;SAAO;QAEV,MAAM,uBAAuB,AAAC,WAAqB,CAAC,EAAE,EAAE,YAAY;QAEpE,OAAO,gJAAY,CAAC,IAAI,CAAC;YACvB,UAAU,MAAM,QAAQ;YACxB,cAAc,OAAO;YACrB,eAAe,OAAO;YACtB,gBAAgB,OAAO;YACvB,sBAAsB,OAAO;QAC/B;IACF,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,6BAA6B;QAC3C,OAAO,gJAAY,CAAC,IAAI,CAAC;YAAE,SAAS;QAAwB,GAAG;YAAE,QAAQ;QAAI;IAC/E;AACF"}}]
}