{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 118, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Administrator/Downloads/SAVR/lib/db.ts"],"sourcesContent":["import mysql from \"mysql2/promise\"\r\n\r\nconst pool = mysql.createPool({\r\n  host: process.env.MYSQL_HOST || \"localhost\",\r\n  user: process.env.MYSQL_USER || \"root\",\r\n  password: process.env.MYSQL_PASSWORD || \"\",\r\n  database: process.env.MYSQL_DATABASE || \"savr\",\r\n  port: Number(process.env.MYSQL_PORT || 3306),\r\n  waitForConnections: true,\r\n  connectionLimit: 10,\r\n  queueLimit: 0,\r\n})\r\n\r\nexport async function executeQuery(query: string, values?: any[]) {\r\n  try {\r\n    const connection = await pool.getConnection()\r\n    const [results] = await connection.execute(query, values)\r\n    connection.release()\r\n    return results\r\n  } catch (error) {\r\n    console.error(\"Database error:\", error)\r\n    throw error\r\n  }\r\n}\r\n\r\nexport default pool\r\n"],"names":[],"mappings":";;;;;;AAAA;;AAEA,MAAM,OAAO,8IAAK,CAAC,UAAU,CAAC;IAC5B,MAAM,QAAQ,GAAG,CAAC,UAAU,IAAI;IAChC,MAAM,QAAQ,GAAG,CAAC,UAAU,IAAI;IAChC,UAAU,QAAQ,GAAG,CAAC,cAAc,IAAI;IACxC,UAAU,QAAQ,GAAG,CAAC,cAAc,IAAI;IACxC,MAAM,OAAO,QAAQ,GAAG,CAAC,UAAU,IAAI;IACvC,oBAAoB;IACpB,iBAAiB;IACjB,YAAY;AACd;AAEO,eAAe,aAAa,KAAa,EAAE,MAAc;IAC9D,IAAI;QACF,MAAM,aAAa,MAAM,KAAK,aAAa;QAC3C,MAAM,CAAC,QAAQ,GAAG,MAAM,WAAW,OAAO,CAAC,OAAO;QAClD,WAAW,OAAO;QAClB,OAAO;IACT,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,mBAAmB;QACjC,MAAM;IACR;AACF;uCAEe"}},
    {"offset": {"line": 152, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Administrator/Downloads/SAVR/app/api/auth/register/route.ts"],"sourcesContent":["import { type NextRequest, NextResponse } from \"next/server\"\r\nimport bcrypt from \"bcryptjs\"\r\nimport jwt from \"jsonwebtoken\"\r\nimport { executeQuery } from \"@/lib/db\"\r\n\r\nexport async function POST(request: NextRequest) {\r\n  try {\r\n    const { email, password, name } = await request.json()\r\n\r\n    // Validate input\r\n    if (!email || !password || !name) {\r\n      return NextResponse.json({ message: \"Missing required fields\" }, { status: 400 })\r\n    }\r\n\r\n    if (password.length < 8) {\r\n      return NextResponse.json({ message: \"Password must be at least 8 characters\" }, { status: 400 })\r\n    }\r\n\r\n    // Check if user already exists\r\n    const existingUsers = await executeQuery(\"SELECT id FROM users WHERE email = ?\", [email])\r\n    if (Array.isArray(existingUsers) && existingUsers.length > 0) {\r\n      return NextResponse.json({ message: \"User already exists\" }, { status: 409 })\r\n    }\r\n\r\n    // Hash password\r\n    const hashedPassword = bcrypt.hashSync(password, 10)\r\n\r\n    // Create user\r\n    const result = await executeQuery(\"INSERT INTO users (email, password_hash, name) VALUES (?, ?, ?)\", [\r\n      email,\r\n      hashedPassword,\r\n      name,\r\n    ])\r\n\r\n    const userId = (result as any).insertId\r\n\r\n    // Create default categories for user\r\n    const defaultCategories = [\r\n      { name: \"Food\", color: \"#FF6B6B\" },\r\n      { name: \"Transport\", color: \"#4ECDC4\" },\r\n      { name: \"Entertainment\", color: \"#45B7D1\" },\r\n      { name: \"Shopping\", color: \"#FFA07A\" },\r\n      { name: \"Bills\", color: \"#98D8C8\" },\r\n      { name: \"Healthcare\", color: \"#FF7675\" },\r\n      { name: \"Education\", color: \"#A29BFE\" },\r\n      { name: \"Other\", color: \"#DFE6E9\" },\r\n    ]\r\n\r\n    for (const category of defaultCategories) {\r\n      // Only insert category if it isn't already present for this user\r\n      const exists = await executeQuery(\"SELECT id FROM categories WHERE user_id = ? AND name = ?\", [userId, category.name])\r\n      if (!Array.isArray(exists) || exists.length === 0) {\r\n        await executeQuery(\"INSERT INTO categories (user_id, name, color) VALUES (?, ?, ?)\", [\r\n          userId,\r\n          category.name,\r\n          category.color,\r\n        ])\r\n      }\r\n    }\r\n\r\n    // Generate JWT token\r\n    const token = jwt.sign({ userId, email }, process.env.JWT_SECRET || \"secret\", {\r\n      expiresIn: \"7d\",\r\n    })\r\n\r\n    return NextResponse.json(\r\n      {\r\n        message: \"User created successfully\",\r\n        accessToken: token,\r\n        user: { id: userId, email, name },\r\n      },\r\n      { status: 201 },\r\n    )\r\n  } catch (error) {\r\n    console.error(\"[v0] Registration error:\", error)\r\n    return NextResponse.json({ message: \"Internal server error\" }, { status: 500 })\r\n  }\r\n}\r\n"],"names":[],"mappings":";;;;AAAA;AACA;AACA;AACA;;;;;AAEO,eAAe,KAAK,OAAoB;IAC7C,IAAI;QACF,MAAM,EAAE,KAAK,EAAE,QAAQ,EAAE,IAAI,EAAE,GAAG,MAAM,QAAQ,IAAI;QAEpD,iBAAiB;QACjB,IAAI,CAAC,SAAS,CAAC,YAAY,CAAC,MAAM;YAChC,OAAO,gJAAY,CAAC,IAAI,CAAC;gBAAE,SAAS;YAA0B,GAAG;gBAAE,QAAQ;YAAI;QACjF;QAEA,IAAI,SAAS,MAAM,GAAG,GAAG;YACvB,OAAO,gJAAY,CAAC,IAAI,CAAC;gBAAE,SAAS;YAAyC,GAAG;gBAAE,QAAQ;YAAI;QAChG;QAEA,+BAA+B;QAC/B,MAAM,gBAAgB,MAAM,IAAA,2HAAY,EAAC,wCAAwC;YAAC;SAAM;QACxF,IAAI,MAAM,OAAO,CAAC,kBAAkB,cAAc,MAAM,GAAG,GAAG;YAC5D,OAAO,gJAAY,CAAC,IAAI,CAAC;gBAAE,SAAS;YAAsB,GAAG;gBAAE,QAAQ;YAAI;QAC7E;QAEA,gBAAgB;QAChB,MAAM,iBAAiB,8IAAM,CAAC,QAAQ,CAAC,UAAU;QAEjD,cAAc;QACd,MAAM,SAAS,MAAM,IAAA,2HAAY,EAAC,mEAAmE;YACnG;YACA;YACA;SACD;QAED,MAAM,SAAS,AAAC,OAAe,QAAQ;QAEvC,qCAAqC;QACrC,MAAM,oBAAoB;YACxB;gBAAE,MAAM;gBAAQ,OAAO;YAAU;YACjC;gBAAE,MAAM;gBAAa,OAAO;YAAU;YACtC;gBAAE,MAAM;gBAAiB,OAAO;YAAU;YAC1C;gBAAE,MAAM;gBAAY,OAAO;YAAU;YACrC;gBAAE,MAAM;gBAAS,OAAO;YAAU;YAClC;gBAAE,MAAM;gBAAc,OAAO;YAAU;YACvC;gBAAE,MAAM;gBAAa,OAAO;YAAU;YACtC;gBAAE,MAAM;gBAAS,OAAO;YAAU;SACnC;QAED,KAAK,MAAM,YAAY,kBAAmB;YACxC,iEAAiE;YACjE,MAAM,SAAS,MAAM,IAAA,2HAAY,EAAC,4DAA4D;gBAAC;gBAAQ,SAAS,IAAI;aAAC;YACrH,IAAI,CAAC,MAAM,OAAO,CAAC,WAAW,OAAO,MAAM,KAAK,GAAG;gBACjD,MAAM,IAAA,2HAAY,EAAC,kEAAkE;oBACnF;oBACA,SAAS,IAAI;oBACb,SAAS,KAAK;iBACf;YACH;QACF;QAEA,qBAAqB;QACrB,MAAM,QAAQ,kJAAG,CAAC,IAAI,CAAC;YAAE;YAAQ;QAAM,GAAG,QAAQ,GAAG,CAAC,UAAU,IAAI,UAAU;YAC5E,WAAW;QACb;QAEA,OAAO,gJAAY,CAAC,IAAI,CACtB;YACE,SAAS;YACT,aAAa;YACb,MAAM;gBAAE,IAAI;gBAAQ;gBAAO;YAAK;QAClC,GACA;YAAE,QAAQ;QAAI;IAElB,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,4BAA4B;QAC1C,OAAO,gJAAY,CAAC,IAAI,CAAC;YAAE,SAAS;QAAwB,GAAG;YAAE,QAAQ;QAAI;IAC/E;AACF"}}]
}